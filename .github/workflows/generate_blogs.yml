name: Generate Daily AI Blogs

on:
  schedule:
    - cron: '0 2 * * *' # 2:00 AM UTC daily (adjust as needed)
  workflow_dispatch:

jobs:
  generate-and-commit:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v3

      - name: Generate AI blog posts via Backend
        env:
          BACKEND_URL: https://resume-analyser-o3eu.onrender.com
        run: |
          echo "🚀 Triggering backend blog generation..."
          curl -X POST "$BACKEND_URL/blogs/generate" \
            -H "Content-Type: application/json" \
            --max-time 300
          echo "✅ Blog generation completed"

      - name: Ping Google Sitemap
        run: |
          echo "🔗 Pinging search engines..."
          curl -X POST "https://resume-analyser-o3eu.onrender.com/blogs/ping-sitemap" \
            --max-time 60
          echo "✅ Sitemap pinged successfully"

      - name: Verify Generation
        run: |
          echo "🔍 Verifying blog generation..."
          curl -X GET "https://resume-analyser-o3eu.onrender.com/blogs" \
            --max-time 30
          echo "✅ Verification completed"


